<?xml version="1.0"?>
<launch>

    <!-- Launch file arguments -->
    <arg name="name"        default="rsu"/>
    <arg name="use_cuda"            default="true"/>
    <arg name="enable_bbox_image"   default="false"/>
    <arg name="max_age"             default="30"/>

    <!-- Launch file constants -->
    <arg name="map_file"    value="$(find svea_core)/maps/sml.yaml" />
    <arg name="depth_image"     value="/zed/zed_node/depth/depth_registered"/>
    <arg name="image"           value="/zed/zed_node/rgb/image_rect_color"/>
    <arg name="websocket_port"  value="9090"/>

    <!-- Publish map -->
    <node name="map_server" pkg="map_server" type="map_server"
          args="$(arg map_file)"
          output="screen" />

    <!-- Start ABConnect -->
    <include file="$(find ros_abconnect)/launch/abconnect.launch">
        <arg name="host"        value="wss://intelligent-cluster-manager.herokuapp.com/signal"/>
        <arg name="name"        value="rsu"/>
        <arg name="category"    value="video"/>
        <arg name="start_delay" value="3"/>
    </include>

    <!-- Connect to topic -->
    <node name="ros_abconnnect__state" pkg="ros_abconnect" type="add_remote_topic.py" output="screen">
        <param name="role"    value="publisher"/>
        <param name="client"  value="corin"/>
        <param name="id"      value="90"/>
        <param name="topic"   value="/rsu/objectposes"/>
        <param name="type"    value="rsu_msgs/StampedObjectPoseArray"/>
    </node>

    <!-- Start object detection & Aruco detection -->
    <include file="$(find rsu_core)/launch/zed_main.launch"/>

</launch>
